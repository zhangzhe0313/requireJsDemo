!function(t,e){"function"==typeof define&&(define.amd||define.cmd)?define(e):t.Follow=e()}(this,function(require){return"function"==typeof require&&require("Enhance"),$.fn.follow=function(t,e){var o={offsets:{x:0,y:0},position:"4-1",edgeAdjust:!0},i=$.extend({},o,e||{});return $(this).each(function(){var e=$(this);if(0!=t.length){var n,r,f,a,s,c=0,u=0,h=e.data("height"),d=e.data("width"),l=$(window).scrollTop(),p=$(window).scrollLeft(),w=parseInt(i.offsets.x,10)||0,g=parseInt(i.offsets.y,10)||0;h||(h=e.outerHeight()),d||(d=e.outerWidth()),n=t.offset(),c=t.outerHeight(),u=t.outerWidth(),r=n.left,f=n.top;var b,m=["4-1","1-4","5-7","2-3","2-1","6-8","3-4","4-3","8-6","1-2","7-5","3-2"],v=i.position,k=!1;$.each(m,function(t,e){if(e===v)return k=!0,!1}),k||(v=o.position);var x=function(t){var e="bottom";switch(t){case"1-4":case"5-7":case"2-3":e="top";break;case"2-1":case"6-8":case"3-4":e="right";break;case"1-2":case"8-6":case"4-3":e="left";break;case"4-1":case"7-5":case"3-2":e="bottom"}return e},y=function(t){return"5-7"===t||"6-8"===t||"8-6"===t||"7-5"===t},I=function(t){if("right"===t){if(r+u+d+w>$(window).width())return!1}else if("bottom"===t){if(f+c+h+g>l+$(window).height())return!1}else if("top"===t){if(h+g>f-l)return!1}else if("left"===t&&d+w>r)return!1;return!0};b=x(v),i.edgeAdjust&&(I(b)?function(){if(!y(v)){var t,e={top:{right:"2-3",left:"1-4"},right:{top:"2-1",bottom:"3-4"},bottom:{right:"3-2",left:"4-1"},left:{top:"1-2",bottom:"4-3"}}[b];if(e)for(t in e)I(t)||(v=e[t])}}():function(){if(y(v))v={"5-7":"7-5","7-5":"5-7","6-8":"8-6","8-6":"6-8"}[v];else{var t={top:{left:"3-2",right:"4-1"},right:{bottom:"1-2",top:"4-3"},bottom:{left:"2-3",right:"1-4"},left:{bottom:"2-1",top:"3-4"}}[b],e=[];for(var o in t)e.push(o);v=I(e[0])||!I(e[1])?t[e[0]]:t[e[1]]}}());var j=x(v),A=v.split("-")[0];switch(j){case"top":s=f-h,a="1"==A?r:"5"===A?r-(d-u)/2:r-(d-u);break;case"right":a=r+u,s="2"==A?f:"6"===A?f-(h-c)/2:f-(h-c);break;case"bottom":s=f+c,a="4"==A?r:"7"===A?r-(d-u)/2:r-(d-u);break;case"left":a=r-d,s="2"==A?f:"6"===A?f-(d-u)/2:f-(h-c)}if(i.edgeAdjust&&y(v)){var z=$(window).width(),H=$(window).height();"7-5"==v||"5-7"==v?a-p<.5*z?a-p<0&&(a=p):a-p+d>z&&(a=z+p-d):s-l<.5*H?s-l<0&&(s=l):s-l+h>H&&(s=H+l-h)}"top"==j||"left"==j?(a-=w,s-=g):(a+=w,s+=g),e.css({position:"absolute",left:Math.round(a),top:Math.round(s)}).attr("data-align",v),e.zIndex&&e.zIndex()}})},function(t,e,o){e.follow(t,o)}});